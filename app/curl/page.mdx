import LinkTo from '@/components/LinkTo'
import Definitions from '@/components/Definitions'
import Avatar from '@/components/ui/avatar'
import Image from 'next/image'
import SyncedVideos from '@/components/SyncedVideos'
import Latex from 'react-latex-next'
import 'katex/dist/katex.min.css';

export const metadata = {
  title: 'Deep Learning for Safer Strength Training',
  description: 'Towards Safer Strength Training with Deep Learning for Rep Failure Prediction',
}

<LinkTo displayText="Back" link="/" />
<br />
<br />


# Paper: Deep Learning for Safer Strength Training

*Towards Safer Strength Training with Deep Learning for Rep Failure Prediction*

**TL;DR**: Alongside <Avatar url="https://unavatar.io/github/Cat2005" name="Caterina Mammola" link="https://caterina.codes/" />, we asked if strength training could be made safer. We show that a deep learning model is capable of predicting with (reasonable) accuracy when a <Definitions text="rep" helperText="(single repetition of a repeated exercise like a squat or a push-up)" /> in a bicep curl <Definitions text="set" helperText="(a group of consecutive repetitions performed without rest)" /> is likely to be a <Definitions text="failure" helperText=", the point at which a muscle can no longer sustain the load and another rep is no longer possible" />. This technique could be expanded to excercises where muscular failure can lead to harm to reduce injury risk during unsupervised workouts. 

We created a novel dataset of >3200 bicep curl reps performed to failure in and trained a Hierarchical LSTM that beats a linear baseline by nearly 30% at identifying the final safe rep. The model analyses joint motion patterns like range of motion and velocity across reps, inspired by Remaining Useful Life prediction from engineering. 

<a href="/curl/towards-safer-strength-training.pdf" className="w-full bg-card rounded-lg group grid sm:grid-cols-2 grid-cols-1 h-20 relative my-20 cursor-pointer text-primary" target="_blank"> 
  <div className="relative col-span-1 h-32 overflow-hidden -translate-y-12">
    <Image src="/mlp-3.jpg" alt="Curl" width={110} height={100} className='absolute bottom-0 left-[45%] -translate-x-1/5 border-card border rounded-sm translate-y-16 rotate-12 group-hover:translate-y-14 group-hover:rotate-[15deg] transition-all duration-200 ease-out'/>
    <Image src="/mlp-2.jpg" alt="Curl" width={120} height={100} className='absolute bottom-0 left-[43%] -translate-x-1/3 border-card border rounded-sm translate-y-16 rotate-3 group-hover:translate-y-14 group-hover:rotate-[6deg] transition-all duration-200 ease-out'/>
    <Image src="/mlp-1.jpg" alt="Curl" width={130} height={100} className='absolute bottom-0 left-[38%] -translate-x-1/2 border-card border rounded-sm translate-y-16 -rotate-6 group-hover:translate-y-16 group-hover:rotate-[-8deg] transition-all duration-200 ease-out'/>
  </div>
  <div className='h-20 flex flex-col-reverse md:flex-row md:items-center absolute md:relative right-4 bottom-0'>
    <h2 className='group-hover:underline my-2 ml-4 h-auto'>View paper ↗</h2>
  </div>
</a>

To decorate the read, the following are a few figures and videos that did not make it into the paper.




Our approach treats rep failure as a boundary detection problem, and we reframe it through the lens of Remaining Useful Life (RUL) prediction, adapting pose-based LSTMs to identify subtle biomechanical cues that precede failure. 



{/* I couldnt be fucked to sync them manually or make one video out of them two on Davinci Resolve */}
<SyncedVideos
  mainVideoSrc="/curl/with-overlay.mp4"
  syncedVideoSrc="/curl/angle-graph.mp4"
/>

We then run a pose estimation model on the video to extract the elbow angle over time. 

<br />

Smooth the graph of elbow angle over time to remove noise and identify points that define the start and end of a rep. 

<video 
  src="/curl/adjusting-curves.mov" 
  className="w-full h-full object-cover"   
  controls={false}
  autoPlay
  muted
  loop
  playsInline 
/>

While tweaking the <Latex children={"$\\sigma$"} /> parameter did not give failproof results (especially for sets with long pauses between reps or irregular reps) a rule based approach worked well.

<br />

To get participants to perform the reps, we used *super advanced* marketing techniques. 


<Image src="/curl/poster.png" alt="Grid" width={1000} height={1000} className="w-2/3 m-auto rounded-sm h-full object-cover" />


*(In the small print we then explain that every set of reps is a ticket to a £40 prize draw, and that the more sets you do, the more tickets you get!)*

<br />


We gathered 254 unique sets from 66 participants, totalling 3272 reps. A sizeable dataset but not enough to compare to other published approaches. 

<video 
  src="/curl/grid.mp4" 
  className="w-full h-full object-cover"   
  controls={false}
  autoPlay
  muted
  loop
  playsInline 
/>

The grid shows a small subset of different reps from different sets and the data we extracted from them. 

What follows is a large amount of tweaking deep learning approaches to improve its performance. We also developed a linear baseline that uses the same features as the model but linear.
